schema: '2.0'
stages:
  loadvoc-fi:
    cmd: venv/bin/annif loadvoc ykl-omikuji-parabel-fi corpora/ykl-classes.tsv
    deps:
    - path: corpora/ykl-classes.tsv
      md5: b2f29070ccedefda72994b8db324e371
      size: 187637
    - path: venv-installed
      md5: c5a0f860381968fb21a3086f9b48068a
      size: 42
    outs:
    - path: data/vocabs/ykl-fi
      md5: 26e5c941da1af79066d396a641c34b7a.dir
      size: 766177
      nfiles: 3
  train-omikuji-parabel-fi:
    cmd: venv/bin/annif train ykl-omikuji-parabel-fi -j 8 corpora/kirjaesittelyt2021/kvesit-ykl-fin-train.tsv
    deps:
    - path: corpora/kirjaesittelyt2021/kvesit-ykl-fin-train.tsv
      md5: 39070df2de1ed470ef21dca2d0a5554d
      size: 44106743
    - path: data/vocabs/ykl-fi
      md5: 26e5c941da1af79066d396a641c34b7a.dir
      size: 766177
      nfiles: 3
    - path: venv-installed
      md5: c5a0f860381968fb21a3086f9b48068a
      size: 42
    outs:
    - path: data/projects/ykl-omikuji-parabel-fi
      md5: a8e068e639682785cfe80714b780d82a.dir
      size: 138002472
      nfiles: 6
  eval-omikuji-parabel-fi:
    cmd: venv/bin/annif eval ykl-omikuji-parabel-fi -j 8 -m Precision@1 -m NDCG --metrics-file
      reports/test-omikuji-parabel-fi.json corpora/kirjaesittelyt2021/kvesit-ykl-fin-test.tsv
    deps:
    - path: corpora/kirjaesittelyt2021/kvesit-ykl-fin-test.tsv
      md5: 9c26fd86d43db53bedef1c0a38f08fc8
      size: 3708388
    - path: data/projects/ykl-omikuji-parabel-fi
      md5: a8e068e639682785cfe80714b780d82a.dir
      size: 138002472
      nfiles: 6
    - path: venv-installed
      md5: c5a0f860381968fb21a3086f9b48068a
      size: 42
    outs:
    - path: reports/test-omikuji-parabel-fi.json
      md5: a1642e074cfbe35627767b670d9f1a9e
      size: 100
  install:
    cmd: python3 -m venv venv && . venv/bin/activate && pip install -U pip wheel setuptools
      && pip install -r requirements.txt && cp requirements.txt venv-installed
    deps:
    - path: requirements.txt
      md5: c5a0f860381968fb21a3086f9b48068a
      size: 42
    outs:
    - path: venv-installed
      md5: c5a0f860381968fb21a3086f9b48068a
      size: 42
